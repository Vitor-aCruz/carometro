{"ast":null,"code":"const API = \"/api\";\n\n// FUNÇÃO PADRÃO PARA CHAMADAS DE API\nexport async function apiFetch(path, opts = {}) {\n  const token = localStorage.getItem(\"token\"); // ← TOKEN AUTOMÁTICO\n\n  const headers = opts.headers || {};\n\n  // Adiciona token\n  if (token) headers[\"X-Auth-Token\"] = token;\n\n  // Evita Content-Type quando body é FormData\n  if (!(opts.body instanceof FormData)) {\n    headers[\"Content-Type\"] = headers[\"Content-Type\"] || \"application/json\";\n  }\n  const res = await fetch(API + path, {\n    ...opts,\n    headers,\n    body: opts.body\n  });\n  if (res.status === 401) {\n    throw new Error(\"unauth\");\n  }\n  return res.json();\n}\n\n// LOGIN (SALVA TOKEN AUTOMATICAMENTE)\nexport async function login(username, password) {\n  const r = await apiFetch(\"/auth/login\", {\n    method: \"POST\",\n    body: JSON.stringify({\n      username,\n      password\n    })\n  });\n\n  // Salva token\n  if (r.token) localStorage.setItem(\"token\", r.token);\n  return r;\n}\n\n// BUSCAR ALUNOS\nexport async function fetchStudents(filters = {}) {\n  const params = new URLSearchParams(filters).toString();\n  return apiFetch(\"/students\" + (params ? \"?\" + params : \"\"), {\n    method: \"GET\"\n  });\n}\n\n// CRIAR ALUNO\nexport async function createStudent(student) {\n  return apiFetch(\"/students\", {\n    method: \"POST\",\n    body: JSON.stringify(student)\n  });\n}\n\n// EDITAR ALUNO\nexport async function updateStudent(id, student) {\n  return apiFetch(\"/students/\" + id, {\n    method: \"PUT\",\n    body: JSON.stringify(student)\n  });\n}\n\n// UPLOAD DE FOTO\nexport async function uploadPhoto(studentId, file) {\n  const formData = new FormData();\n  formData.append(\"file\", file);\n  const token = localStorage.getItem(\"token\");\n  const res = await fetch(`/api/students/${studentId}/photo`, {\n    method: \"POST\",\n    headers: {\n      \"X-Auth-Token\": token\n    },\n    body: formData\n  });\n  if (res.status === 401) throw new Error(\"unauth\");\n  return res.json();\n}\n\n// CRIAR AVALIAÇÃO\nexport async function createEvaluation(ev) {\n  return apiFetch(\"/evaluations\", {\n    method: \"POST\",\n    body: JSON.stringify(ev)\n  });\n}\n\n// ÚLTIMAS 5 AVALIAÇÕES\nexport async function last5(studentId) {\n  return apiFetch(`/evaluations/student/${studentId}/last5`, {\n    method: \"GET\"\n  });\n}","map":{"version":3,"names":["API","apiFetch","path","opts","token","localStorage","getItem","headers","body","FormData","res","fetch","status","Error","json","login","username","password","r","method","JSON","stringify","setItem","fetchStudents","filters","params","URLSearchParams","toString","createStudent","student","updateStudent","id","uploadPhoto","studentId","file","formData","append","createEvaluation","ev","last5"],"sources":["/home/rafael/Downloads/carometro_project-20251126T191010Z-1-001/carometro_project/frontend/src/services/api.js"],"sourcesContent":["const API = \"/api\";\n\n// FUNÇÃO PADRÃO PARA CHAMADAS DE API\nexport async function apiFetch(path, opts = {}) {\n  const token = localStorage.getItem(\"token\"); // ← TOKEN AUTOMÁTICO\n\n  const headers = opts.headers || {};\n\n  // Adiciona token\n  if (token) headers[\"X-Auth-Token\"] = token;\n\n  // Evita Content-Type quando body é FormData\n  if (!(opts.body instanceof FormData)) {\n    headers[\"Content-Type\"] = headers[\"Content-Type\"] || \"application/json\";\n  }\n\n  const res = await fetch(API + path, {\n    ...opts,\n    headers,\n    body: opts.body\n  });\n\n  if (res.status === 401) {\n    throw new Error(\"unauth\");\n  }\n\n  return res.json();\n}\n\n// LOGIN (SALVA TOKEN AUTOMATICAMENTE)\nexport async function login(username, password) {\n  const r = await apiFetch(\"/auth/login\", {\n    method: \"POST\",\n    body: JSON.stringify({ username, password })\n  });\n\n  // Salva token\n  if (r.token) localStorage.setItem(\"token\", r.token);\n\n  return r;\n}\n\n// BUSCAR ALUNOS\nexport async function fetchStudents(filters = {}) {\n  const params = new URLSearchParams(filters).toString();\n  return apiFetch(\"/students\" + (params ? \"?\" + params : \"\"), {\n    method: \"GET\"\n  });\n}\n\n// CRIAR ALUNO\nexport async function createStudent(student) {\n  return apiFetch(\"/students\", {\n    method: \"POST\",\n    body: JSON.stringify(student)\n  });\n}\n\n// EDITAR ALUNO\nexport async function updateStudent(id, student) {\n  return apiFetch(\"/students/\" + id, {\n    method: \"PUT\",\n    body: JSON.stringify(student)\n  });\n}\n\n// UPLOAD DE FOTO\nexport async function uploadPhoto(studentId, file) {\n  const formData = new FormData();\n  formData.append(\"file\", file);\n\n  const token = localStorage.getItem(\"token\");\n\n  const res = await fetch(`/api/students/${studentId}/photo`, {\n    method: \"POST\",\n    headers: { \"X-Auth-Token\": token },\n    body: formData\n  });\n\n  if (res.status === 401) throw new Error(\"unauth\");\n\n  return res.json();\n}\n\n// CRIAR AVALIAÇÃO\nexport async function createEvaluation(ev) {\n  return apiFetch(\"/evaluations\", {\n    method: \"POST\",\n    body: JSON.stringify(ev)\n  });\n}\n\n// ÚLTIMAS 5 AVALIAÇÕES\nexport async function last5(studentId) {\n  return apiFetch(`/evaluations/student/${studentId}/last5`, {\n    method: \"GET\"\n  });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}